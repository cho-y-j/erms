# 건설장비 및 인력 관리 시스템 (ERMS) - 사용자 역할 및 접속 방법

**작성일**: 2025-10-26  
**버전**: 2.0

---

## 👥 사용자 역할 (Role) 정의

시스템은 **6가지 역할**로 구성되어 있으며, 각 역할마다 접근 권한과 기능이 다릅니다.

| 역할 | 영문명 | 설명 | 소속 회사 |
|------|--------|------|-----------|
| 관리자 | Admin | 시스템 전체 관리 | 없음 (시스템 관리자) |
| 장비임대 사업자 | Owner | 장비 및 인력 소유, 반입 요청 | Owner 회사 |
| 시공사 | BP (Building Partner) | 반입 요청 1차 승인 | BP 회사 |
| 발주처 | EP (End Partner) | 반입 요청 최종 승인 | EP 회사 |
| 작업자 | Worker | 현장 작업, GPS 위치 전송 | Owner 회사 |
| 안전점검원 | Inspector | 현장 안전점검 (미사용) | BP/EP 회사 |

---

## 🔐 접속 방법

### 1. Admin / Owner / BP / EP 접속 방법

**URL**: https://3001-i2rbu5qzksu646zz8h6uy-87777a64.manus-asia.computer

#### 로그인 화면

- **이메일**: 사용자 이메일 주소
- **비밀번호**: 사용자 비밀번호

#### 기본 Admin 계정

```
이메일: admin@test.com
비밀번호: admin123
```

#### 테스트 Owner 계정 (예시)

```
이메일: owner@company.com
비밀번호: owner123
```

---

### 2. Worker 접속 방법 (모바일 앱)

**URL**: https://3001-i2rbu5qzksu646zz8h6uy-87777a64.manus-asia.computer/mobile/worker

#### PIN 로그인

- **PIN 번호**: 4자리 숫자 (예: 1234)
- 이메일/비밀번호 없이 PIN만으로 간편 로그인

#### Worker 등록 시 PIN 설정

1. Admin 또는 Owner가 "사용자 관리"에서 Worker 등록
2. PIN 번호 4자리 설정 (예: 1234)
3. Worker는 모바일 앱에서 PIN으로 로그인

---

## 🎯 역할별 접근 권한 및 기능

### 1. Admin (관리자)

#### 접근 가능한 메뉴

| 메뉴 | 기능 | 설명 |
|------|------|------|
| **대시보드** | 조회 | 전체 시스템 통계 |
| **회사 관리** | CRUD | Owner/BP/EP 회사 등록, 수정, 삭제 |
| **사용자 관리** | CRUD | 모든 역할의 사용자 등록, 수정, 삭제 |
| **장비 유형 관리** | CRUD | 장비 유형 및 필수 서류 설정 |
| **인력 유형 관리** | CRUD | 인력 유형 및 필수 서류 설정 |
| **장비 관리** | 조회 | 모든 회사의 장비 조회 (등록 불가) |
| **인력 관리** | 조회 | 모든 회사의 인력 조회 (등록 불가) |
| **서류 관리** | 조회, 삭제 | 모든 서류 조회 및 삭제 |
| **반입 요청** | 조회 | 모든 반입 요청 조회 (생성 불가) |
| **실시간 위치 추적** | 조회 | 모든 Worker의 실시간 위치 조회 |
| **긴급 알림** | 조회, 해결 | 모든 긴급 알림 조회 및 해결 처리 |
| **작업 현황 모니터링** | 조회 | 모든 Worker의 작업 현황 조회 |

#### 주요 업무

1. **시스템 초기 설정**
   - Owner/BP/EP 회사 등록
   - 각 회사의 사용자 등록
   - 장비 유형 및 인력 유형 설정

2. **시스템 모니터링**
   - 전체 시스템 통계 확인
   - 긴급 알림 모니터링
   - 작업 현황 모니터링

3. **문제 해결**
   - 서류 문제 해결
   - 사용자 문제 해결

---

### 2. Owner (장비임대 사업자)

#### 접근 가능한 메뉴

| 메뉴 | 기능 | 설명 |
|------|------|------|
| **대시보드** | 조회 | 자사 통계 (장비, 인력, 반입 요청) |
| **장비 관리** | CRUD | 자사 장비 등록, 수정, 삭제, 서류 업로드 |
| **인력 관리** | CRUD | 자사 인력 등록, 수정, 삭제, 서류 업로드 |
| **서류 관리** | 조회, 삭제 | 자사 서류 조회 및 삭제 |
| **반입 요청** | CRUD | BP 회사 선택하여 반입 요청 생성 |
| **투입 관리** | CRUD | 투입 등록 및 관리 |
| **작업 확인서** | 조회 | 작업 확인서 조회 |
| **실시간 위치 추적** | 조회 | 자사 Worker의 실시간 위치 조회 |
| **긴급 알림** | 조회, 해결 | 자사 Worker의 긴급 알림 조회 및 해결 |
| **작업 현황 모니터링** | 조회 | 자사 Worker의 작업 현황 조회 |

#### 주요 업무

1. **장비 및 인력 관리**
   - 장비 등록 (등록 번호, 유형, 필수 서류 업로드)
   - 인력 등록 (이름, 유형, 필수 서류 업로드)
   - 서류 만료일 관리

2. **반입 요청 프로세스**
   - **Step 1**: BP 회사 선택
   - **Step 2**: 장비 및 인력 선택
   - **Step 3**: 서류 검증 (필수 서류 체크)
   - **Step 4**: 반입 목적, 투입 예정일, 철수 예정일 입력
   - **Step 5**: 반입 요청 제출

3. **작업 현황 모니터링**
   - Worker의 실시간 위치 확인
   - 작업 시간 및 휴식 시간 확인
   - 긴급 알림 확인 및 대응

---

### 3. BP (시공사)

#### 접근 가능한 메뉴

| 메뉴 | 기능 | 설명 |
|------|------|------|
| **대시보드** | 조회 | 반입 요청 통계 |
| **반입 요청** | 승인/반려 | Owner의 반입 요청 검토 및 승인 |
| **작업 확인서** | 승인/반려 | 작업 확인서 검토 및 전자서명 |

#### 주요 업무

1. **반입 요청 승인 프로세스**
   - **Step 1**: Owner의 반입 요청 확인
   - **Step 2**: 장비 및 인력 서류 검토
   - **Step 3**: 작업계획서 업로드
   - **Step 4**: EP 회사 선택
   - **Step 5**: 승인 또는 반려

2. **작업 확인서 승인**
   - 작업 내용 확인
   - 전자서명 (Canvas 기반)
   - 승인 또는 반려

---

### 4. EP (발주처)

#### 접근 가능한 메뉴

| 메뉴 | 기능 | 설명 |
|------|------|------|
| **대시보드** | 조회 | 반입 요청 통계 |
| **반입 요청** | 최종 승인/반려 | BP의 반입 요청 최종 승인 |

#### 주요 업무

1. **반입 요청 최종 승인**
   - **Step 1**: BP의 반입 요청 확인
   - **Step 2**: 작업계획서 검토
   - **Step 3**: 최종 승인 또는 반려

---

### 5. Worker (작업자)

#### 접근 가능한 메뉴 (모바일 앱)

| 메뉴 | 기능 | 설명 |
|------|------|------|
| **작업 시작** | 버튼 | 작업 시작 (GPS 위치 자동 전송 시작) |
| **작업 종료** | 버튼 | 작업 종료 (GPS 위치 전송 중지) |
| **휴식 시작** | 버튼 | 휴식 시작 |
| **휴식 종료** | 버튼 | 휴식 종료 |
| **긴급 상황 발생** | 버튼 | 긴급 알림 전송 (GPS 위치 포함) |

#### 주요 업무

1. **작업 시작/종료**
   - "작업 시작" 버튼 클릭 → GPS 위치 자동 전송 시작 (5분 간격)
   - "작업 종료" 버튼 클릭 → GPS 위치 전송 중지

2. **휴식 관리**
   - "휴식 시작" 버튼 클릭 → 휴식 시간 기록
   - "휴식 종료" 버튼 클릭 → 작업 재개

3. **긴급 상황 대응**
   - "긴급 상황 발생" 버튼 클릭
   - 긴급 유형 선택 (사고/고장/안전위험/기타)
   - 상세 설명 입력
   - GPS 위치 자동 포함하여 전송

---

## 📱 모바일 앱 (Worker) 사용 방법

### 1. 로그인

1. 모바일 브라우저에서 Worker 앱 URL 접속
2. PIN 번호 4자리 입력 (예: 1234)
3. "로그인" 버튼 클릭

### 2. 작업 시작

1. "작업 시작" 버튼 클릭
2. ✅ GPS 위치 자동 전송 시작 (5분 간격)
3. ✅ 화면에 "위치 정보 전송 중 (5분 간격)" 표시
4. ✅ 경과 시간 실시간 표시

### 3. 휴식

1. "휴식 시작" 버튼 클릭
2. ✅ 휴식 시간 기록 시작
3. "휴식 종료" 버튼 클릭
4. ✅ 작업 재개

### 4. 작업 종료

1. "작업 종료" 버튼 클릭
2. ✅ GPS 위치 전송 중지
3. ✅ 작업 세션 종료

### 5. 긴급 상황 발생

1. **빨간색 "긴급 상황 발생"** 버튼 클릭
2. 긴급 유형 선택:
   - 1: 사고
   - 2: 고장
   - 3: 안전위험
   - 4: 기타
3. 상세 설명 입력
4. "전송" 버튼 클릭
5. ✅ GPS 위치 자동 포함하여 긴급 알림 전송
6. ✅ Admin/Owner에게 즉시 알림

---

## 🔄 반입 요청 프로세스 (Owner → BP → EP)

### 전체 프로세스

```
Owner (장비임대 사업자)
  ↓
  1. BP 회사 선택
  2. 장비 및 인력 선택
  3. 서류 검증 (필수 서류 체크)
  4. 반입 목적, 투입 예정일, 철수 예정일 입력
  5. 반입 요청 제출
  ↓
BP (시공사)
  ↓
  1. 반입 요청 확인
  2. 장비 및 인력 서류 검토
  3. 작업계획서 업로드
  4. EP 회사 선택
  5. 승인 또는 반려
  ↓
EP (발주처)
  ↓
  1. 반입 요청 확인
  2. 작업계획서 검토
  3. 최종 승인 또는 반려
  ↓
반입 완료 ✅
```

### Owner: 반입 요청 생성

1. **"반입 요청"** 메뉴 클릭
2. **"새 반입 요청"** 버튼 클릭
3. **BP 회사 선택** (필수) ✨
   - 드롭다운에서 BP 회사 선택
   - 예: "ABC 시공사"
4. **장비 선택**
   - 체크박스로 장비 선택
   - 인력 페어링 가능 (선택사항)
5. **인력 선택**
   - 체크박스로 인력 선택
6. **서류 검증** (필수)
   - "서류 검증" 버튼 클릭
   - 필수 서류 체크:
     - 장비: 면허증, 보험증
     - 인력: 자격증, 건강검진
   - ✅ 모든 서류가 승인 상태이고 만료되지 않아야 함
7. **반입 정보 입력**
   - 투입 목적
   - 투입 예정일
   - 철수 예정일
8. **"반입 요청 제출"** 버튼 클릭
9. ✅ 반입 요청 생성 완료 (상태: owner_requested)

### BP: 반입 요청 승인

1. **"반입 요청"** 메뉴 클릭
2. **"BP 검토 대기"** 탭 선택
3. 반입 요청 선택
4. **"승인"** 버튼 클릭
5. **작업계획서 업로드** (필수)
   - 파일 선택 또는 URL 입력
6. **EP 회사 선택** (필수)
   - 드롭다운에서 EP 회사 선택
   - 예: "XYZ 발주처"
7. **코멘트 입력** (선택사항)
8. **"승인"** 버튼 클릭
9. ✅ BP 승인 완료 (상태: bp_approved)

### EP: 반입 요청 최종 승인

1. **"반입 요청"** 메뉴 클릭
2. **"EP 검토 대기"** 탭 선택
3. 반입 요청 선택
4. **작업계획서 확인**
5. **"최종 승인"** 버튼 클릭
6. **코멘트 입력** (선택사항)
7. **"승인"** 버튼 클릭
8. ✅ EP 최종 승인 완료 (상태: ep_approved)

---

## 📊 대시보드 통계

### Admin 대시보드

- 전체 회사 수 (Owner/BP/EP)
- 전체 사용자 수
- 전체 장비 수
- 전체 인력 수
- 전체 반입 요청 수
- 긴급 알림 수 (활성)
- 작업 중인 Worker 수

### Owner 대시보드

- 자사 장비 수
- 자사 인력 수
- 반입 요청 수 (대기/승인/반려)
- 투입 중인 장비 및 인력 수
- 긴급 알림 수 (자사 Worker)
- 작업 중인 Worker 수

### BP/EP 대시보드

- 검토 대기 중인 반입 요청 수
- 승인한 반입 요청 수
- 반려한 반입 요청 수

---

## 🗺️ 실시간 위치 추적

### Admin/Owner: 위치 추적 페이지

1. **"실시간 위치 추적"** 메뉴 클릭
2. ✅ Google Maps에 모든 활성 Worker의 위치 표시
3. ✅ 마커 클릭 시 Worker 정보 표시:
   - 이름
   - 장비 정보
   - 마지막 위치 전송 시간
4. ✅ 10초마다 자동 새로고침

### Worker: GPS 위치 전송

- 작업 시작 시 자동으로 GPS 위치 전송 시작
- 5분 간격으로 자동 전송
- 작업 종료 시 자동으로 전송 중지

---

## 🚨 긴급 알림 시스템

### Worker: 긴급 알림 전송

1. **"긴급 상황 발생"** 버튼 클릭 (빨간색 버튼)
2. 긴급 유형 선택:
   - 1: 사고
   - 2: 고장
   - 3: 안전위험
   - 4: 기타
3. 상세 설명 입력
4. "전송" 버튼 클릭
5. ✅ GPS 위치 자동 포함하여 전송

### Admin/Owner: 긴급 알림 확인 및 해결

1. **"긴급 알림"** 메뉴 클릭
2. ✅ 긴급 알림 목록 확인 (상태별 필터링)
   - 활성 (active)
   - 해결됨 (resolved)
   - 오보 (false_alarm)
3. ✅ Google Maps에서 긴급 위치 확인
4. **"해결 처리"** 버튼 클릭
5. 해결 내용 입력
6. "해결 완료" 버튼 클릭
7. ✅ 긴급 알림 해결 (상태: resolved)

---

## ⏱️ 작업 현황 모니터링

### Admin/Owner: 작업 현황 페이지

1. **"작업 현황 모니터링"** 메뉴 클릭
2. ✅ 통계 카드 확인:
   - 작업 중 (working)
   - 휴식 중 (break)
   - 연장 작업 (overtime)
   - 휴식 필요 (4시간 이상 연속 작업)
3. ✅ 작업 중인 Worker 목록 확인:
   - Worker 이름
   - 장비 정보
   - 작업 시작 시간
   - 경과 시간 (실시간 업데이트)
   - 마지막 휴식 시간
   - 총 휴식 시간
4. ✅ 휴식 필요 경고 표시:
   - 4시간 이상 연속 작업 시 빨간색 경고 표시
   - "휴식이 필요합니다. (근로기준법 준수)"

---

## 🔒 보안 및 권한

### 1. 인증 (Authentication)

- **JWT 토큰** 기반 인증
- 로그인 시 토큰 발급
- 모든 API 요청 시 토큰 검증

### 2. 권한 (Authorization)

- **역할 기반 접근 제어 (RBAC)**
- 각 API는 특정 역할만 접근 가능
- 예: `companies.create`는 Admin만 가능

### 3. 데이터 필터링

- **Owner**: 자사 데이터만 조회
- **BP**: 자사가 관련된 반입 요청만 조회
- **EP**: 자사가 관련된 반입 요청만 조회
- **Admin**: 모든 데이터 조회 가능

---

## 📞 문의 및 지원

시스템 사용 중 문제가 발생하거나 문의사항이 있을 경우:

1. **Admin에게 문의**
2. **개발팀에게 문의**

---

**작성일**: 2025-10-26  
**작성자**: AI Assistant  
**버전**: 2.0


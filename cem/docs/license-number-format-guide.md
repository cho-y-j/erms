# 운전면허번호 입력 가이드

## 📋 면허번호 형식

운전면허번호는 **총 12자리**입니다:

```
[지역코드 2자리] - [발급연도 2자리] - [일련번호 6자리] - [검증번호 2자리]
```

**예시:**
```
면허증 표시: 충남 99-619984-50
실제 12자리: 16-99-619984-50 (충남=16)
입력 형식:   1699619984-50 또는 16-99-619984-50
```

---

## 🗺️ 지역 코드표

| 지역명 | 코드 | 지역명 | 코드 |
|--------|------|--------|------|
| 서울 | 11 | 전북 | 17 |
| 부산 | 12 | 전남 | 18 |
| **경기** | **13** | 경북 | 19 |
| 강원 | 14 | 경남 | 20 |
| 충북 | 15 | 제주 | 21 |
| **충남** | **16** | 대구 | 22 |
| | | 인천 | 23 |
| | | 광주 | 24 |
| | | 대전 | 25 |
| | | 울산 | 26 |

---

## ✍️ 입력 예시

### 예시 1: 충남 면허증
```
┌────────────────────────────────────┐
│ 면허증 표시:                       │
│ 충남 99-619984-50                  │
│                                    │
│ 입력할 값:                         │
│ 16-99-619984-50                    │
│ (충남 = 16)                        │
└────────────────────────────────────┘
```

### 예시 2: 서울 면허증
```
┌────────────────────────────────────┐
│ 면허증 표시:                       │
│ 서울 11-123456-78                  │
│                                    │
│ 입력할 값:                         │
│ 11-11-123456-78                    │
│ (서울 = 11)                        │
└────────────────────────────────────┘
```

### 예시 3: 경기 면허증
```
┌────────────────────────────────────┐
│ 면허증 표시:                       │
│ 경기 13-456789-01                  │
│                                    │
│ 입력할 값:                         │
│ 13-13-456789-01                    │
│ (경기 = 13)                        │
└────────────────────────────────────┘
```

---

## 🎯 UI 입력 가이드

### LicenseUploadWithOCR 컴포넌트에서:

```typescript
<Label>면허번호 * (12자리)</Label>
<Input
  placeholder="예: 16-99-619984-50"
  helperText="⚠️ 지역코드 포함 12자리를 입력하세요 (충남→16, 서울→11 등)"
/>

<Alert className="bg-blue-50">
  <AlertDescription>
    <div className="text-sm">
      <div className="font-semibold mb-1">💡 입력 방법:</div>
      <ol className="list-decimal list-inside space-y-1">
        <li>면허증에 표시된 지역명(충남, 서울 등)을 확인</li>
        <li>위 표에서 해당 지역의 숫자 코드 확인</li>
        <li>지역코드 + 숫자 12자리 입력</li>
      </ol>
      <div className="mt-2 p-2 bg-white rounded border">
        <strong>예:</strong> "충남 99-619984-50" → <strong>"16-99-619984-50"</strong> 입력
      </div>
    </div>
  </AlertDescription>
</Alert>
```

---

## 🔧 OCR 자동 추출

OCR이 면허증에서 "충남 99-619984-50"를 인식하면:

1. "충남" 추출 → 지역코드 "16"으로 변환
2. "99-619984-50" 추출
3. 합쳐서 "16-99-619984-50" (12자리) 자동 입력

**OCR 코드 예시:**

```typescript
const regionCodeMap: Record<string, string> = {
  '서울': '11', '부산': '12', '경기': '13', '강원': '14',
  '충북': '15', '충남': '16', '전북': '17', '전남': '18',
  '경북': '19', '경남': '20', '제주': '21', '대구': '22',
  '인천': '23', '광주': '24', '대전': '25', '울산': '26',
};

// "충남 99-619984-50" → "16996199 8450"
const match = text.match(/(충남|서울|...) (\d{2})-(\d{6})-(\d{2})/);
if (match) {
  const [_, region, year, serial, check] = match;
  const regionCode = regionCodeMap[region];
  const licenseNum = `${regionCode}${year}${serial}${check}`; // "1699619984-50"
}
```

---

## ❗ 주의사항

### 1. **하이픈(-) 제거**
입력값에서 하이픈을 제거하여 순수 12자리 숫자만 RIMS API에 전송:

```typescript
const cleanLicenseNum = licenseNum.replace(/-/g, ''); // "1699619984-50" → "169961998450"
```

### 2. **12자리 검증**
```typescript
if (cleanLicenseNum.length !== 12) {
  throw new Error('면허번호는 12자리여야 합니다');
}
```

### 3. **지역명 없는 면허증**
- 일부 오래된 면허증은 지역명이 숫자로 표시
- 이미 12자리라면 그대로 입력

---

## 🧪 테스트 케이스

| 면허증 표시 | 입력 값 | 정제 후 (API 전송) | 결과 |
|-------------|---------|-------------------|------|
| 충남 99-619984-50 | 16-99-619984-50 | 16996199 8450 | ✅ |
| 서울 11-123456-78 | 11-11-123456-78 | 111112345678 | ✅ |
| 13-13-456789-01 | 13-13-456789-01 | 131345678901 | ✅ |
| 경기 99-123456-78 | 99-123456-78 | 9912345678 | ❌ 10자리 |
| 16996199 8450 | 16996199 8450 | 169961998450 | ✅ |

---

## 🚀 사용 플로우

### **Admin/Owner가 Worker 등록:**

```
1. 면허증 사진 업로드 📸
   ↓
2. OCR 자동 추출
   - 지역명: "충남" → 코드 "16"
   - 면허번호: "99-619984-50"
   - 합쳐서: "16-99-619984-50"
   ↓
3. 자동 입력된 값 확인 및 수정
   [16-99-619984-50]
   ↓
4. [🔍 면허 인증] 클릭
   ↓
5. RIMS API 호출
   - 하이픈 제거: "16996199 8450"
   - 검증 요청
   ↓
6. ✅ 인증 완료!
```

---

## 📞 문제 해결

### "면허번호는 12자리여야 합니다" 오류
- **원인**: 지역코드를 빼먹었거나, 잘못 입력
- **해결**: 지역코드표를 보고 앞에 2자리 추가

### "인증 실패: 일치하지 않음" 오류
- **원인**: 이름 또는 면허번호가 잘못됨
- **해결**: 면허증을 다시 확인하고 정확히 입력

### "지역 코드를 모르겠어요"
- **해결**: 위 지역 코드표 참고
- 충남=16, 서울=11, 경기=13이 가장 많이 사용됨

---

## 🎯 결론

**면허번호 = 지역코드(2) + 발급연도(2) + 일련번호(6) + 검증(2) = 12자리**

면허증에 "충남 99-619984-50"가 표시되어 있다면:
- 충남 = 16
- 입력: **16-99-619984-50**
- API 전송: **16996199 8450** (12자리)

✅ **이제 명확합니다!**



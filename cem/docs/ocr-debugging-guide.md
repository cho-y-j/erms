# OCR 디버깅 가이드

## 🐛 OCR이 정보를 추출하지 못할 때

### 1. 브라우저 콘솔 확인

**개발자 도구 열기:**
- Windows: `F12` 또는 `Ctrl + Shift + I`
- Mac: `Cmd + Option + I`

**Console 탭에서 다음 로그 확인:**

```
========================================
[OCR] Raw text (원본): 운전면허증 서울11123456789012 홍길동 ...
========================================
[OCR Parser] 정규화된 텍스트: ...
[OCR Parser] 패턴1 매치 (지역명 포함): 111234567890
[OCR Parser] 이름 후보: ['운전면허증', '홍길동', '도로교통공단']
[OCR Parser] 최종 선택된 이름: 홍길동
[OCR Parser] 생년월일 패턴1 매치: 1990-01-01
[OCR Parser] 면허종별 매치: 1종 보통
[OCR Parser] 최종 신뢰도: 100%
========================================
[OCR] 추출된 정보:
  - 이름: 홍길동
  - 면허번호: 111234567890
  - 생년월일: 1990-01-01
  - 면허종별: 1종 보통
  - 신뢰도: 100%
========================================
```

---

### 2. OCR 결과가 이상할 때

**원인:**
- 이미지 품질이 낮음
- 글자가 흐릿함
- 각도가 틀어짐

**해결책:**
1. **밝은 곳에서 다시 촬영**
2. **면허증을 평평하게**
3. **카메라 초점 맞추기**
4. **해상도 높은 이미지 사용**

---

### 3. 면허번호가 추출되지 않을 때

**면허번호 형식:**
- `서울11-12-345678-90` (지역명 포함)
- `11-12-345678-90` (지역명 없음)
- `111234567890` (하이픈 없음)

**체크리스트:**
- [ ] 면허번호가 명확하게 보이는가?
- [ ] 숫자가 겹쳐 보이지 않는가?
- [ ] 12자리 숫자인가?

**수동 입력:**
- OCR이 실패해도 수동으로 입력 가능
- 면허번호 입력란에 직접 입력

---

### 4. 이름이 추출되지 않을 때

**체크리스트:**
- [ ] 이름이 한글인가?
- [ ] 2~4자 이름인가?
- [ ] 이름 주변에 다른 글자가 많지 않은가?

**수동 입력:**
- 이름 입력란에 직접 입력

---

### 5. 이미지 품질 향상 팁

**✅ 좋은 이미지:**
- 밝은 조명 (낮 또는 밝은 LED 조명)
- 정면 촬영 (각도 0도)
- 초점이 맞음
- 배경이 단색 (흰색 권장)
- 해상도 1280x720 이상

**❌ 나쁜 이미지:**
- 어두운 조명
- 비스듬한 각도
- 흐릿함
- 배경에 패턴이 많음
- 해상도가 낮음

---

### 6. 수동 입력 후 인증

OCR이 실패해도 괜찮습니다!

**방법:**
1. 면허증 이미지를 보고
2. **수동으로 입력**:
   - 이름: 홍길동
   - 면허번호: 11-12-345678-90 (하이픈은 자동 제거됨)
   - 면허종별: 1종 보통
3. **[🔍 면허 인증]** 버튼 클릭
4. RIMS API로 진위 확인

---

### 7. Tesseract.js 성능 개선

**더 나은 결과를 위해:**

1. **이미지 전처리** (향후 추가 가능):
   - 회전 보정
   - 대비 조정
   - 노이즈 제거
   - 이진화 (흑백 변환)

2. **OCR 옵션 조정**:
```typescript
const worker = await Tesseract.createWorker('kor', 1, {
  tessedit_char_whitelist: '0123456789가-힣.-년월일종대형보통소형원동기',
  tessedit_pageseg_mode: Tesseract.PSM.SINGLE_BLOCK,
});
```

---

### 8. 로그 분석 예시

#### 성공 케이스
```
[OCR] Raw text: 운전면허증 서울11123456789012 홍길동 1990.01.01 1종보통
[OCR Parser] 패턴1 매치: 111234567890
[OCR Parser] 최종 선택된 이름: 홍길동
[OCR Parser] 최종 신뢰도: 100%
✅ 모든 정보 추출 성공!
```

#### 부분 실패 케이스
```
[OCR] Raw text: 운전면허증 서로11123아5678아012 홍길똥 1990..01
[OCR Parser] 패턴1 매치: (추출 실패)
[OCR Parser] 최종 선택된 이름: (추출 실패)
[OCR Parser] 최종 신뢰도: 10%
⚠️ 수동 수정 필요!
```

---

### 9. 자주 묻는 질문 (FAQ)

**Q: OCR이 너무 느려요 (10초 이상)**
- A: 이미지 크기를 줄이세요 (권장: 1280x720)
- A: 브라우저를 재시작하세요

**Q: "tesseract worker failed to load" 에러**
- A: 인터넷 연결 확인 (CDN 로딩 필요)
- A: 브라우저 캐시 삭제

**Q: 신뢰도가 계속 낮게 나와요**
- A: 이미지 품질을 개선하세요
- A: 수동 입력 후 인증하세요

**Q: 면허 인증은 성공했는데 OCR은 실패해요**
- A: 괜찮습니다! 수동 입력 → 인증 → 등록 가능

---

### 10. 테스트 이미지 권장

**테스트용 면허증 이미지 만들기:**

1. 실제 면허증 촬영
2. 또는 면허증 스캔 (300 DPI 이상)
3. 이미지 편집:
   - 크기: 1280x720 픽셀
   - 포맷: JPG 또는 PNG
   - 용량: 1MB 이하

---

**문제가 계속되면 콘솔 로그를 캡처해서 공유해주세요!** 🐛



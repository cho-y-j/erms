# ëª¨ë°”ì¼ ë¡œê·¸ì¸ ë°©ì‹ ê°œì„  ì œì•ˆ

## ğŸ“Œ í˜„ì¬ ë¬¸ì œì 

### âŒ PIN ë²ˆí˜¸ë§Œìœ¼ë¡œ ë¡œê·¸ì¸
```
Worker A: PIN 1234
Worker B: PIN 1234  â† ì¤‘ë³µ ê°€ëŠ¥! ëˆ„ê°€ ë¡œê·¸ì¸í•œ ê±´ì§€ êµ¬ë¶„ ë¶ˆê°€
```

**ë¬¸ì œ:**
1. âœ— PIN ì¤‘ë³µ ê°€ëŠ¥ (4ìë¦¬ ìˆ«ìë§Œìœ¼ë¡œëŠ” ê³ ìœ ì„± ë³´ì¥ ë¶ˆê°€)
2. âœ— ë³´ì•ˆ ì·¨ì•½ (ìˆ«ì 4ìë¦¬ëŠ” ì‰½ê²Œ ì¶”ì¸¡ ê°€ëŠ¥)
3. âœ— DB ì¿¼ë¦¬ì—ì„œ `.single()` ì‚¬ìš© â†’ ì¤‘ë³µ ì‹œ ì—ëŸ¬ ë°œìƒ
4. âœ— Worker ê°„ ì¶©ëŒ ê°€ëŠ¥ì„±

**í˜„ì¬ ì½”ë“œ:**
```typescript
// server/db.ts
export async function getWorkerByPinCode(pinCode: string) {
  const { data, error } = await supabase
    .from('workers')
    .select('*')
    .eq('pin_code', pinCode)
    .single();  // â† ì¤‘ë³µ PINì´ë©´ ì—ëŸ¬!
}
```

---

## âœ… ì œì•ˆ: ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸ ë¡œê·¸ì¸ + ìë™ ë¡œê·¸ì¸

### 1ï¸âƒ£ **ì²« ë¡œê·¸ì¸: ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ” ëª¨ë°”ì¼ ë¡œê·¸ì¸            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ì´ë©”ì¼                      â”‚
â”‚  [worker@company.com]        â”‚
â”‚                              â”‚
â”‚  ë¹„ë°€ë²ˆí˜¸                    â”‚
â”‚  [â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢]                  â”‚
â”‚                              â”‚
â”‚  â˜‘ï¸ ì´ ê¸°ê¸°ì— ë¡œê·¸ì¸ ìœ ì§€     â”‚
â”‚                              â”‚
â”‚  [ë¡œê·¸ì¸]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2ï¸âƒ£ **ë‹¤ìŒë¶€í„°: ìë™ ë¡œê·¸ì¸**

```
ê¸°ê¸°ì— ì €ì¥ëœ ì¸ì¦ í† í°ìœ¼ë¡œ ìë™ ë¡œê·¸ì¸
â†“
ì•± ì‹¤í–‰ â†’ ì¦‰ì‹œ ë©”ì¸ í™”ë©´
```

---

## ğŸ¯ ê°œì„  ë°©ì•ˆ ë¹„êµ

| í•­ëª© | í˜„ì¬ (PIN) | ì œì•ˆ (Email + Password + ìë™) |
|-----|-----------|------------------------------|
| **ë³´ì•ˆ** | âŒ ë‚®ìŒ (4ìë¦¬ ìˆ«ì) | âœ… ë†’ìŒ (ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸) |
| **ì¤‘ë³µ ê°€ëŠ¥ì„±** | âŒ ë†’ìŒ | âœ… ì—†ìŒ (ì´ë©”ì¼ì€ ê³ ìœ ) |
| **ì‚¬ìš© í¸ì˜ì„±** | â–³ ë§¤ë²ˆ 4ìë¦¬ ì…ë ¥ | âœ… í•œ ë²ˆ ë¡œê·¸ì¸ â†’ ìë™ ë¡œê·¸ì¸ |
| **Worker êµ¬ë¶„** | âŒ PIN ì¤‘ë³µ ì‹œ êµ¬ë¶„ ë¶ˆê°€ | âœ… ì´ë©”ì¼ë¡œ ëª…í™•íˆ êµ¬ë¶„ |
| **ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •** | âŒ ê´€ë¦¬ìë§Œ ê°€ëŠ¥ | âœ… ë³¸ì¸ì´ ì¬ì„¤ì • ê°€ëŠ¥ |
| **ë‹¤ì¤‘ ê¸°ê¸° ì§€ì›** | â–³ ê°€ëŠ¥í•˜ì§€ë§Œ ë¶ˆí¸ | âœ… ê° ê¸°ê¸°ì—ì„œ ìë™ ë¡œê·¸ì¸ |

---

## ğŸ”§ êµ¬í˜„ ë°©ì•ˆ

### A. **ê°œì„ ì•ˆ 1: ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸ (ì¶”ì²œ) â­**

```typescript
// 1ï¸âƒ£ ì²« ë¡œê·¸ì¸
loginMutation.mutate({
  email: "worker@company.com",
  password: "SecurePass123!",
  rememberMe: true  // ìë™ ë¡œê·¸ì¸ ì²´í¬ë°•ìŠ¤
});

// 2ï¸âƒ£ ë¡œê·¸ì¸ ì„±ê³µ ì‹œ í† í° ì €ì¥
localStorage.setItem('authToken', data.token);
localStorage.setItem('refreshToken', data.refreshToken);

// 3ï¸âƒ£ ì•± ì‹¤í–‰ ì‹œ ìë™ ë¡œê·¸ì¸
const token = localStorage.getItem('authToken');
if (token) {
  // í† í°ìœ¼ë¡œ ìë™ ë¡œê·¸ì¸
  autoLoginMutation.mutate({ token });
}
```

**ì¥ì :**
- âœ… ë³´ì•ˆ ê°•í™” (ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸)
- âœ… ì¤‘ë³µ ë¶ˆê°€ (ì´ë©”ì¼ì€ ê³ ìœ )
- âœ… ì‚¬ìš©ì í¸ì˜ì„± ìµœê³  (í•œ ë²ˆë§Œ ë¡œê·¸ì¸)
- âœ… í‘œì¤€ ì¸ì¦ ë°©ì‹

**ë‹¨ì :**
- â–³ ì²« ë¡œê·¸ì¸ ì‹œ ì´ë©”ì¼ ì…ë ¥ í•„ìš” (í•˜ì§€ë§Œ í•œ ë²ˆë§Œ)

---

### B. **ê°œì„ ì•ˆ 2: PIN + íšŒì‚¬ ì½”ë“œ**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  íšŒì‚¬ ì½”ë“œ: ABC123           â”‚  â† íšŒì‚¬ë³„ ê³ ìœ  ì½”ë“œ
â”‚  PIN: 1234                   â”‚  â† Workerë³„ PIN
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì¤‘ë³µ ë°©ì§€: íšŒì‚¬ì½”ë“œ + PIN ì¡°í•©ìœ¼ë¡œ ê³ ìœ ì„± ë³´ì¥
ì˜ˆ: ABC123-1234, XYZ789-1234 (ë‹¤ë¥¸ Worker)
```

**ì¥ì :**
- âœ… ê¸°ì¡´ PIN ë°©ì‹ ìœ ì§€
- âœ… íšŒì‚¬ ë‹¨ìœ„ë¡œ PIN ì¤‘ë³µ ë°©ì§€

**ë‹¨ì :**
- âŒ ì—¬ì „íˆ íšŒì‚¬ ë‚´ì—ì„œ PIN ì¤‘ë³µ ê°€ëŠ¥
- âŒ íšŒì‚¬ ì½”ë“œë¥¼ ê¸°ì–µí•´ì•¼ í•¨
- âŒ ë³´ì•ˆ ì—¬ì „íˆ ë‚®ìŒ

---

### C. **ê°œì„ ì•ˆ 3: QR ì½”ë“œ ë¡œê·¸ì¸**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“± QR ì½”ë“œë¡œ ë¡œê·¸ì¸         â”‚
â”‚                              â”‚
â”‚  ê´€ë¦¬ìê°€ ë°œê¸‰í•œ QR ì½”ë“œë¥¼   â”‚
â”‚  ìŠ¤ìº”í•˜ì„¸ìš”                  â”‚
â”‚                              â”‚
â”‚  [ì¹´ë©”ë¼ ì—´ê¸°]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì¥ì :**
- âœ… í¸ë¦¬í•¨ (QR ìŠ¤ìº”ë§Œ)
- âœ… ë³´ì•ˆ (QRì— ì•”í˜¸í™”ëœ í† í°)

**ë‹¨ì :**
- âŒ QR ì½”ë“œ ë°œê¸‰ ì‹œìŠ¤í…œ í•„ìš”
- âŒ ì¹´ë©”ë¼ ê¶Œí•œ í•„ìš”
- âŒ ê°œë°œ ë³µì¡ë„ ë†’ìŒ

---

## ğŸ“Š ìµœì¢… ì¶”ì²œ: **ê°œì„ ì•ˆ 1 (ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸ + ìë™ ë¡œê·¸ì¸)** â­

### ì´ìœ :

1. **ë³´ì•ˆ ê°•í™”**: ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸ëŠ” ì—…ê³„ í‘œì¤€
2. **ì¤‘ë³µ ë°©ì§€**: ì´ë©”ì¼ì€ ê³ ìœ í•˜ë¯€ë¡œ Worker êµ¬ë¶„ ëª…í™•
3. **ì‚¬ìš©ì í¸ì˜ì„±**: í•œ ë²ˆë§Œ ë¡œê·¸ì¸í•˜ë©´ ìë™ ë¡œê·¸ì¸
4. **í‘œì¤€ ì¸ì¦**: JWT í† í° ê¸°ë°˜, ë¦¬í”„ë ˆì‹œ í† í°ìœ¼ë¡œ ë³´ì•ˆ ìœ ì§€
5. **ê¸°ì¡´ ì‹œìŠ¤í…œ í˜¸í™˜**: ë°ìŠ¤í¬í†±ê³¼ ë™ì¼í•œ ì¸ì¦ ë°©ì‹

### ì‚¬ìš©ì ê²½í—˜:

```
ğŸ“± ì²« ì‚¬ìš©:
1. ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸ ì…ë ¥
2. "ì´ ê¸°ê¸°ì— ë¡œê·¸ì¸ ìœ ì§€" ì²´í¬
3. ë¡œê·¸ì¸

ğŸ“± ë‹¤ìŒë¶€í„°:
1. ì•± ì‹¤í–‰ â†’ ì¦‰ì‹œ ë©”ì¸ í™”ë©´
   (ì¸ì¦ í† í°ìœ¼ë¡œ ìë™ ë¡œê·¸ì¸)
```

---

## ğŸš€ êµ¬í˜„ ìˆœì„œ

### 1ë‹¨ê³„: ëª¨ë°”ì¼ ë¡œê·¸ì¸ í˜ì´ì§€ ìˆ˜ì •
- PIN ì…ë ¥ â†’ ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸ ì…ë ¥
- "ë¡œê·¸ì¸ ìœ ì§€" ì²´í¬ë°•ìŠ¤ ì¶”ê°€

### 2ë‹¨ê³„: ì¸ì¦ í† í° ì €ì¥
- localStorageì— authToken, refreshToken ì €ì¥
- í† í° ë§Œë£Œ ì‹œ ìë™ ê°±ì‹ 

### 3ë‹¨ê³„: ìë™ ë¡œê·¸ì¸ êµ¬í˜„
- ì•± ì‹¤í–‰ ì‹œ í† í° í™•ì¸
- ìœ íš¨í•œ í† í°ì´ ìˆìœ¼ë©´ ìë™ ë¡œê·¸ì¸

### 4ë‹¨ê³„: ë³´ì•ˆ ê°•í™”
- í† í° ì•”í˜¸í™” ì €ì¥
- ë¦¬í”„ë ˆì‹œ í† í°ìœ¼ë¡œ ë³´ì•ˆ ìœ ì§€
- ë¡œê·¸ì•„ì›ƒ ì‹œ í† í° ì‚­ì œ

---

## ğŸ“ ì˜ˆìƒ ì½”ë“œ

### ëª¨ë°”ì¼ ë¡œê·¸ì¸ í˜ì´ì§€
```typescript
export default function MobileLogin() {
  const [email, setEmail] = useState("");
  const [password, setPassword] = useState("");
  const [rememberMe, setRememberMe] = useState(true);

  const loginMutation = trpc.auth.login.useMutation({
    onSuccess: (data) => {
      if (rememberMe) {
        // í† í° ì €ì¥
        localStorage.setItem('authToken', data.token);
        localStorage.setItem('refreshToken', data.refreshToken);
      }
      setLocation("/mobile/worker");
    },
  });

  return (
    <form onSubmit={(e) => {
      e.preventDefault();
      loginMutation.mutate({ email, password });
    }}>
      <Input
        type="email"
        placeholder="ì´ë©”ì¼"
        value={email}
        onChange={(e) => setEmail(e.target.value)}
      />
      <Input
        type="password"
        placeholder="ë¹„ë°€ë²ˆí˜¸"
        value={password}
        onChange={(e) => setPassword(e.target.value)}
      />
      <Checkbox
        checked={rememberMe}
        onCheckedChange={setRememberMe}
      >
        ì´ ê¸°ê¸°ì— ë¡œê·¸ì¸ ìœ ì§€
      </Checkbox>
      <Button type="submit">ë¡œê·¸ì¸</Button>
    </form>
  );
}
```

### ìë™ ë¡œê·¸ì¸ ì²´í¬
```typescript
// App.tsx ë˜ëŠ” ìµœìƒìœ„ ì»´í¬ë„ŒíŠ¸
useEffect(() => {
  const token = localStorage.getItem('authToken');
  if (token) {
    // í† í° ìœ íš¨ì„± í™•ì¸ í›„ ìë™ ë¡œê·¸ì¸
    autoLoginMutation.mutate({ token });
  }
}, []);
```

---

## ğŸ¯ ê²°ë¡ 

**PIN ë°©ì‹ì˜ ë¬¸ì œ:**
- âŒ ì¤‘ë³µ ê°€ëŠ¥
- âŒ ë³´ì•ˆ ì·¨ì•½
- âŒ Worker êµ¬ë¶„ ë¶ˆê°€

**ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸ + ìë™ ë¡œê·¸ì¸ì˜ ì¥ì :**
- âœ… ë³´ì•ˆ ê°•í™”
- âœ… ì¤‘ë³µ ë¶ˆê°€
- âœ… ì‚¬ìš©ì í¸ì˜ì„± ìµœê³ 
- âœ… í‘œì¤€ ì¸ì¦ ë°©ì‹

**ì¶”ì²œ: ê°œì„ ì•ˆ 1 (ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸ + ìë™ ë¡œê·¸ì¸)** â­







